# 家庭争端解决器 - 开发需求文档

## 一、项目概述

**项目名称**: 家庭争端解决器
**目标用户**: 有多个小孩的家庭
**核心价值**: 通过随机选择的方式解决家庭中多个小孩都不愿先完成某项任务的争端（如洗澡、刷牙等）

## 二、用户故事

1. **US-1 项目管理**
   - 作为家长，我想要创建多个随机项目（如"谁先洗澡"、"谁先刷牙"），以便在不同场景下使用

2. **US-2 候选人管理**
   - 作为家长，我想要配置候选人信息（姓名、照片），以便随机选择时能够识别

3. **US-3 随机选择**
   - 作为家长，我想要通过动画效果随机选择一个候选人，让过程看起来公平且有趣

4. **US-4 历史记录**
   - 作为家长，我想要查看历史选择记录，了解每次选择的结果和时间

## 三、功能需求

### 3.1 首页
- 展示所有已创建的随机项目列表
- 每个项目显示项目名称
- 提供点击项目进入详情的操作
- 在项目列表底部显示"添加新项目"按钮

### 3.2 项目详情页
- 显示该项目下所有候选人的卡片（姓名 + 照片）
- 显示"开始 [项目名称]"按钮
- 点击按钮后触发随机选择动画

### 3.3 随机选择动画
- **轮流动画**:
  - 依次高亮每个候选人卡片
  - 被高亮的候选人：描边高光 + 正常亮度
  - 未被高亮的候选人：低光显示
  - 速度控制：开始时快速轮转，逐渐减速，最后停在随机选中的候选人上
  - 动画时长：约 3-5 秒

- **庆祝动画**:
  - 轮流动画结束后播放彩纸/丝带效果
  - 动画从屏幕两侧向中间汇聚（类似手持礼炮）
  - 突出显示最终选中的候选人

### 3.4 历史记录页
- 记录每次随机选择的结果
- 每条记录包含：项目名称、选中的候选人、选择时间
- 按时间倒序排列（最新的在最前）
- 提供返回上一级按钮

### 3.5 候选人管理页
- 显示所有候选人列表
- 支持添加新候选人：
  - 输入姓名（必填）
  - 上传照片（可选）
- 支持编辑候选人信息
- 支持删除候选人
- 提供返回上一级按钮

### 3.6 添加/编辑项目页
- 输入项目名称（必填）
- 为项目选择候选人（从候选人库中多选）
- 保存项目
- 提供返回上一级按钮

### 3.7 菜单/导航
- 提供菜单按钮访问：
  - 历史记录
  - 候选人管理
  - 返回首页

## 四、界面设计

### 4.1 设计风格
- 参考 YouTube Kids 风格
- 特点：
  - 鲜艳明快的配色
  - 大圆角按钮
  - 卡片式布局
  - 简洁易读的字体
  - 友好的视觉反馈

### 4.2 页面结构
- **导航栏**: 顶部固定，显示菜单按钮和当前页面标题
- **主内容区**: 各页面主要内容
- **底部操作栏**: 根据页面显示相应操作按钮

### 4.3 通用交互
- 所有页面提供返回上一级按钮
- 重要操作提供确认提示
- 加载状态提供视觉反馈

## 五、数据模型

### 5.1 用户
```
- id: 唯一标识
- username: 用户名（可选，用于多用户隔离）
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.2 项目
```
- id: 唯一标识
- name: 项目名称
- user_id: 所属用户
- candidate_ids: 候选人ID列表（JSON数组）
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.3 候选人
```
- id: 唯一标识
- name: 姓名
- photo_url: 照片URL（可选）
- user_id: 所属用户
- created_at: 创建时间
- updated_at: 更新时间
```

### 5.4 历史记录
```
- id: 唯一标识
- project_id: 项目ID
- project_name: 项目名称（冗余存储，避免联表）
- candidate_id: 选中的候选人ID
- candidate_name: 候选人姓名（冗余存储）
- selected_at: 选择时间
- user_id: 所属用户
```

## 六、技术栈

### 6.1 前端
- **框架**: React 18+
- **路由**: React Router
- **状态管理**: Context API / Zustand
- **样式**: Tailwind CSS / CSS Modules
- **动画**: Framer Motion
- **HTTP客户端**: Axios

### 6.2 后端
- **语言**: Go 1.25
- **Web框架**: Gin / Fiber
- **数据库**: SQLite
- **ORM**: GORM

### 6.3 API设计（RESTful）

**项目相关**
- `GET /api/projects` - 获取项目列表
- `POST /api/projects` - 创建项目
- `PUT /api/projects/:id` - 更新项目
- `DELETE /api/projects/:id` - 删除项目
- `GET /api/projects/:id` - 获取项目详情

**候选人相关**
- `GET /api/candidates` - 获取候选人列表
- `POST /api/candidates` - 创建候选人
- `PUT /api/candidates/:id` - 更新候选人
- `DELETE /api/candidates/:id` - 删除候选人
- `POST /api/candidates/:id/photo` - 上传候选人照片

**历史记录相关**
- `GET /api/history?project_id=xxx&limit=20` - 获取历史记录
- `POST /api/history` - 记录选择结果

**随机选择相关**
- `POST /api/randomize` - 执行随机选择
  - 请求体: `{ project_id }`
  - 响应: `{ candidate_id, candidate_name }`

## 七、非功能性需求

### 7.1 性能
- 页面首次加载时间 < 2秒
- 动画流畅度 >= 60fps
- 支持 10+ 候选人同时显示

### 7.2 兼容性
- 浏览器：Chrome/Safari 最新两个版本
- 设备：响应式设计，支持手机、平板、桌面端

### 7.3 数据存储
- 照片文件存储在本地文件系统
- 数据库文件存储在用户本地
- 支持数据导出功能（可选）

## 八、开发优先级

### Phase 1 - MVP（最小可行产品）
1. 用户系统（基础版）
2. 候选人管理（CRUD）
3. 项目管理（CRUD）
4. 随机选择动画
5. 历史记录查看

### Phase 2 - 增强功能
1. 照片上传
2. 庆祝动画优化
3. 数据导出
4. 多用户支持
